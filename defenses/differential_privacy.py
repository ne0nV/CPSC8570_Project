<full differential_privacy.py content from earlier>