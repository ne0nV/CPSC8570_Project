<full monitoring.py content from earlier>